To save the final output of train and test datasets with actual vs predicted tags, follow this complete approach. ğŸš€

ğŸ“Œ Steps
1ï¸âƒ£ Run Model Predictions on Train & Test Data
2ï¸âƒ£ Convert Predictions from IDs to Text Labels
3ï¸âƒ£ Align Words with Actual & Predicted Tags
4ï¸âƒ£ Save the Results in CSV Format

ğŸ”¹ Step 1: Generate Predictions
python
Copy
Edit
import numpy as np

def get_predictions(trainer, dataset):
    predictions_output = trainer.predict(dataset)
    predictions = np.argmax(predictions_output.predictions, axis=2)  # Convert logits to label indices
    labels = predictions_output.label_ids  # Get actual label indices

    true_labels = [[id2label[label] for label in label_seq if label != -100] for label_seq in labels]
    pred_labels = [[id2label[pred] for pred, label in zip(pred_seq, label_seq) if label != -100] 
                   for pred_seq, label_seq in zip(predictions, labels)]
    
    return true_labels, pred_labels
âœ… This removes padding tokens (-100) to keep only relevant words.

ğŸ”¹ Step 2: Save Predictions in CSV Format
python
Copy
Edit
import pandas as pd

def save_predictions(sentences, true_labels, pred_labels, filename):
    data = []
    for sentence, actual, predicted in zip(sentences, true_labels, pred_labels):
        for word, act_tag, pred_tag in zip(sentence, actual, predicted):
            data.append([word[0], act_tag, pred_tag])

    df = pd.DataFrame(data, columns=["Word", "Actual_Tag", "Predicted_Tag"])
    df.to_csv(filename, index=False)
    print(f"âœ… Saved: {filename}")

# ğŸ”¹ Predict & Save Train Data
train_true, train_pred = get_predictions(trainer, dataset_train)
save_predictions(dataset_train, train_true, train_pred, "final_train_predictions.csv")

# ğŸ”¹ Predict & Save Test Data
test_true, test_pred = get_predictions(trainer, dataset_test)
save_predictions(dataset_test, test_true, test_pred, "final_test_predictions.csv")
âœ… The final output files will be saved as: 1ï¸âƒ£ final_train_predictions.csv
2ï¸âƒ£ final_test_predictions.csv

ğŸ“‚ Expected CSV Output Format
Word	Actual_Tag	Predicted_Tag
Elon	B-PER	B-PER
Musk	I-PER	I-PER
founded	O	O
SpaceX	B-ORG	B-ORG
in	O	O
2002	B-DATE	B-DATE
âœ… Summary
Extracted predictions for Train & Test sets
Converted label IDs into text labels
Saved results in CSV format for easy comparison
Now you can compare Actual vs. Predicted Tags in the final files. ğŸš€

Would you like to add more insights like error analysis? ğŸ”
